"use strict";define("bundles/programming/components/SubmissionInfo",["require","exports","module","react-with-addons","underscore","bundles/phoenix/components/Tag","bundles/phoenix/components/Time","i18n!nls/programming","bundles/programming/components/SubmissionPartTable","bundles/programming/models/immediate/assignmentParts","bundles/programming/models/submissionSummary","bundles/ondemand/stores/ProgressStore","bundles/ondemand/stores/SessionStore","bundles/ondemand/appContextSingleton","css!bundles/programming/components/__styles__/SubmissionInfo.css"],function(require,exports,module){var e=require("react-with-addons"),_=require("underscore"),a=require("bundles/phoenix/components/Tag"),s=require("bundles/phoenix/components/Time"),n=require("i18n!nls/programming"),r=require("bundles/programming/components/SubmissionPartTable"),d=require("bundles/programming/models/immediate/assignmentParts"),i=require("bundles/programming/models/submissionSummary"),o=require("bundles/ondemand/stores/ProgressStore"),l=require("bundles/ondemand/stores/SessionStore"),m=require("bundles/ondemand/appContextSingleton");require("css!bundles/programming/components/__styles__/SubmissionInfo.css");var t=e.createClass({displayName:"SubmissionInfo",propTypes:{submission:e.PropTypes.instanceOf(i).isRequired,assignmentParts:e.PropTypes.instanceOf(d).isRequired,moduleId:e.PropTypes.string.isRequired,title:e.PropTypes.string},getDefaultProps:function getDefaultProps(){return{title:n("Submission")}},getInitialState:function getInitialState(){return{isExpanded:this.props.isExpanded||!1}},handleExpanderClick:function handleExpanderClick(e){e.preventDefault(),e.target.blur(),this.setState({isExpanded:!this.state.isExpanded})},renderGrade:function renderGrade(){var s=this.props.submission;if(l.isEnrolled()&&s.get("evaluation").isPassed()){var i=s.get("evaluation"),d=s.get("submittedAt"),t=i.getPercentScore(),c=m.getComponentContext().getStore("CourseScheduleStore"),u=c.getDeadlineForModuleId(this.props.moduleId),r=o.getPenalizedScore(u,d,t),a=r.penaltyPercent,p=r.penalizedScoreInPercent;if(a>0)return e.createElement("div",{className:"c-grade-card"},e.createElement("div",null,e.createElement("strong",null,n("Grade"))),e.createElement("h3",{className:"heading"},e.createElement("span",null,t," - ",a," = "),e.createElement("span",null,p,"%")),e.createElement("div",{className:"color-hint-text caption"},n("Late penalty applied")))}},render:function render(){var t=this.props.submission,l=this.props.assignmentParts,o=this.state.isExpanded,i=t.get("evaluation"),m=function partTable(){return e.createElement(r,{assignmentParts:l,evaluations:t.get("partEvaluations")})};return e.createElement("div",{href:"#",className:"rc-SubmissionInfo well",onClick:this.handleExpanderClick},e.createElement("a",{href:"#",className:"pull-right",onClick:this.handleExpanderClick},n(o?"less":"more")),e.createElement("h6",null,this.props.title),e.createElement("div",{className:"c-score-card"},e.createElement("div",null,e.createElement("strong",null,n("Score"))),e.createElement("h3",{className:"heading"},i.get("score")," / ",i.get("maxScore")," ",n("points earned"),i.isPassed()&&e.createElement(a,{type:"success",label:n("PASSED")})),e.createElement("div",{className:"color-hint-text caption"},n("Submitted on")," ",e.createElement(s,{time:t.get("submittedAt")}))),this.renderGrade(),o&&m())}});module.exports=t});